#!/usr/bin/env php
<?php

declare(strict_types=1);

use App\Command\CreateAppCommand;
use Symfony\Component\Console\Application;

// Look for the autoloader in a few possible locations
$autoloaderPaths = [
    __DIR__ . '/../vendor/autoload.php', // Local development
    __DIR__ . '/../../../autoload.php', // Installed as a Composer dependency
];

$autoloaderFound = false;
foreach ($autoloaderPaths as $path) {
    if (file_exists($path)) {
        require_once $path;
        $autoloaderFound = true;
        break;
    }
}

if (!$autoloaderFound) {
    fwrite(STDERR, "Could not find vendor/autoload.php. Did you run 'composer install'?" . PHP_EOL);
    exit(1);
}

try {
    $application = new Application('PoolPilot');
    $application->addCommand(new CreateAppCommand());

    exit($application->run());

} catch (Throwable $e) {
    fwrite(STDERR, 'An error occurred: ' . $e->getMessage() . "\n");
    exit(1);
}
